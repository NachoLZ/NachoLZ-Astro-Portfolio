---
import { TAGS } from "./TechTags.astro";
import { getI18N } from "../i18n";
import { getProjectImages } from "../utils/imageUtils";
import ProjectItem from "./ProjectItem.astro";

const { currentLocale } = Astro;
const i18n = getI18N({ currentLocale });

// Static data that doesn't need translation
const PROJECTS_STATIC = [
  {
    name: "Yoho",
    image: "/projects/Yoho/cover.webp",
    link: "https://yoho-experiences.vercel.app/",
    tags: [
      TAGS.NEXT,
      TAGS.POSTGRESQL,
      TAGS.REACT,
      TAGS.TAILWIND,
      TAGS.TYPESCRIPT,
      TAGS.FIGMA,
      TAGS.VERCEL,
    ],
  },
  {
    name: "Video Overlay Pipeline and Subtitle Editor",
    github: "https://github.com/NachoLZ/VideoClipPy",
    image: "/projects/VideoClipPy/thumbnail.webp",
    tags: [TAGS.REACT, TAGS.TAILWIND, TAGS.PYTHON],
  },
  {
    name: "Modern Fintech Landing Page",
    link: "https://block-capital.cl",
    image: "/projects/Modern Fintech Landing Page/bc snippet.webp",
    tags: [TAGS.WEBFLOW, TAGS.PHOTOSHOP],
  },
  {
    name: "Handy God",
    link: "https://nacholz.itch.io/handy-god",
    github: "https://github.com/NachoLZ/HandyGod/",
    image: "/projects/handygod-stand.webp",
    tags: [TAGS.UNITY, TAGS.CSHARP, TAGS.PHOTOSHOP],
  },
];

// Combine static data with translations
const PROJECTS = PROJECTS_STATIC.map((project, index) => {
  const images = getProjectImages(project.name);
  return {
    ...project,
    date: i18n.projects.entries[index].date,
    title: i18n.projects.entries[index].title,
    description: i18n.projects.entries[index].description,
    images: images, // Store images for later use
  };
});

// Calculate starting indices for each project
let imageIndexCounter = 0;
const projectsWithStartIndices = PROJECTS.map((project) => {
  const startImageIndex = imageIndexCounter;
  imageIndexCounter += project.images.length;
  return {
    ...project,
    startImageIndex: startImageIndex,
  };
});
---

<div class="flex flex-col gap-y-16">
  {projectsWithStartIndices.map((project) => <ProjectItem project={project} />)}
</div>
